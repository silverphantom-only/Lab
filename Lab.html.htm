<!doctype html>
<html lang="eS">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Generador de p√°ginas para Laboratoristas</title>
  <style>
    :root{
      --accent:#0077c2;
      --bg:#ffffff;
      --text:#222;
      --muted:#666;
      --card:#f7f9fc;
      --brand-font: "Helvetica Neue", Arial, sans-serif;
    }
    body{
      margin:0;
      font-family:var(--brand-font);
      background:linear-gradient(180deg,#f1f4f8,white);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
    }
    header.appbar{
      display:flex;
      gap:16px;
      align-items:center;
      padding:18px 24px;
      background:rgba(255,255,255,0.9);
      box-shadow:0 2px 6px rgba(20,30,50,0.06);
      position:sticky;
      top:0;
      z-index:10;
    }
    .logo-preview{
      width:48px;height:48px;border-radius:8px;background:var(--card);
      display:flex;align-items:center;justify-content:center;font-weight:700;color:var(--muted);
      overflow:hidden;
    }
    .app-title{font-weight:700;font-size:18px}
    main{display:grid;grid-template-columns:420px 1fr;gap:20px;padding:20px;max-width:1200px;margin:18px auto;width:calc(100% - 48px);}
    .panel{background:white;padding:16px;border-radius:10px;box-shadow:0 6px 20px rgba(30,40,60,0.06);overflow:auto;max-height:75vh}
    .panel h2{margin:0 0 12px 0;font-size:16px}
    label{display:block;margin:8px 0 6px 0;font-size:13px;color:var(--muted)}
    input[type="text"], input[type="color"], textarea, select{
      width:100%;padding:8px;border-radius:8px;border:1px solid #e5edf5;background:#fff;font-size:14px;
    }
    textarea{min-height:70px;resize:vertical}
    .row{display:flex;gap:10px}
    .btn{appearance:none;border:0;padding:10px 12px;border-radius:8px;background:var(--accent);color:white;cursor:pointer;font-weight:600}
    .btn.secondary{background:#f1f3f5;color:var(--text)}
    .sections-list{margin-top:8px;display:flex;flex-direction:column;gap:10px}
    .section-item{padding:8px;border-radius:8px;border:1px dashed #e6eef8;background:linear-gradient(180deg,#fff,#fbfdff)}
    .section-item .controls{display:flex;gap:8px;align-items:center;margin-top:8px}
    .preview-wrap{display:flex;flex-direction:column;gap:10px;height:75vh}
    iframe#preview{flex:1;border-radius:10px;border:1px solid #e2e8f0;background:white}
    .actions{display:flex;gap:8px;flex-wrap:wrap}
    footer.credits{padding:12px;text-align:center;color:var(--muted);font-size:13px}

    .hint{font-size:13px;color:#4b5563}
  </style>
</head>
<body>
  <header class="appbar">
    <div class="logo-preview" id="appLogo">LAB</div>
    <div>
      <div class="app-title">Generador de P√°ginas ‚Äî Laboratoristas</div>
      <div class="small">Plantillas replicables ‚Äî cambia pocas cosas y listo</div>
    </div>
  </header>

  <main>

    <section class="panel">
      <h2>Configuraci√≥n b√°sica</h2>

      <label for="labName">Nombre del laboratorio</label>
      <input id="labName" type="text" value="Laboratorio Cl√≠nico San Jos√©" />

      <label for="tagline">Tagline / Descripci√≥n corta</label>
      <input id="tagline" type="text" value="Diagn√≥stico confiable | Resultados r√°pidos" />

      <label for="phoneNumber">Tel√©fono (para bot√≥n llamar)</label>
      <input id="phoneNumber" type="text" placeholder="+521234567890" />   <!-- BOT√ìN NUEVO -->

      <label for="whatsappNumber">WhatsApp (solo n√∫meros)</label>
      <input id="whatsappNumber" type="text" placeholder="521234567890" />  <!-- BOT√ìN NUEVO -->

      <div class="row" style="margin-top:8px">
        <div style="flex:1">
          <label for="accent">Color principal</label>
          <input id="accent" type="color" value="#0077c2" />
        </div>
        <div style="flex:1">
          <label for="textColor">Color de texto</label>
          <input id="textColor" type="color" value="#222222" />
        </div>
      </div>

      <label for="logoFile">Logo</label>
      <input id="logoFile" type="file" accept="image/*" />

      <label for="heroImageUrl">Imagen Hero</label>
      <input id="heroImageUrl" type="text" placeholder="https://..." />


      <h2>Secciones</h2>
      <div class="sections-list" id="sectionsList"></div>

      <div style="display:flex;gap:8px;margin-top:10px">
        <button class="btn" id="addSectionBtn">+ A√±adir secci√≥n</button>
        <button class="btn secondary" id="resetSectionsBtn">Restablecer plantilla</button>
      </div>

      <h2>Exportar</h2>
      <div class="actions">
        <button class="btn" id="generateBtn">Generar HTML</button>
        <button class="btn secondary" id="downloadBtn">Descargar .html</button>
        <button class="btn secondary" id="openNewTabBtn">Abrir en nueva pesta√±a</button>
      </div>
    </section>

    <section class="panel preview-wrap">
      <h2>Previsualizaci√≥n</h2>
      <iframe id="preview"></iframe>
    </section>

  </main>

  <footer class="credits">Hecho para laboratoristas ‚Äî cambia textos, colores e im√°genes</footer>

  <script>

  const defaultConfig = {
    labName: "Laboratorio Cl√≠nico San Jos√©",
    tagline: "Diagn√≥stico confiable | Resultados r√°pidos",
    accent: "#0077c2",
    textColor: "#222",
    logoData: null,
    heroImage: "",
    phoneNumber: "",
    whatsappNumber: "",
    sections: [
      { id: idGen(), title: "Sobre nosotros", content: "<p>M√°s de 15 a√±os brindando resultados confiables.</p>" },
      { id: idGen(), title: "Servicios", content: "<ul><li>Hematolog√≠a</li><li>Bioqu√≠mica</li></ul>" },
      { id: idGen(), title: "Contacto", content: "<p>Direcci√≥n ejemplo.</p>" }
    ]
  };

  const state = JSON.parse(JSON.stringify(defaultConfig));
  const el = id => document.getElementById(id);

  function idGen(){ return 's-'+Math.random().toString(36).substr(2,9); }

  const phoneInput = el("phoneNumber");
  const whatsappInput = el("whatsappNumber");

  phoneInput.addEventListener("input", ()=>{
    state.phoneNumber = phoneInput.value;
    updatePreview();
  });

  whatsappInput.addEventListener("input", ()=>{
    state.whatsappNumber = whatsappInput.value;
    updatePreview();
  });

  /* ------------ RESTO DEL C√ìDIGO IGUAL, SOLO AGREGO BOTONES EN generateFullHTML() ----------------- */

  function generateFullHTML(){

    const callBtn = state.phoneNumber ? `
      <a href="tel:${state.phoneNumber}" style="
        display:inline-block;padding:12px 18px;background:#0077c2;color:white;
        border-radius:8px;text-decoration:none;font-weight:600;margin-right:10px;
      ">üìû Llamar</a>` : "";

    const waBtn = state.whatsappNumber ? `
      <a href="https://wa.me/${state.whatsappNumber}" target="_blank" style="
        display:inline-block;padding:12px 18px;background:#25D366;color:white;
        border-radius:8px;text-decoration:none;font-weight:600;
      ">üí¨ WhatsApp</a>` : "";

    const sectionsHtml = state.sections.map(s=>`
      <section class="site-section">
        <div class="container">
          <h2>${s.title}</h2>
          <div>${s.content}</div>
          ${s.title.toLowerCase().includes("contacto") ? `<div style="margin-top:20px">${callBtn} ${waBtn}</div>` : ""}
        </div>
      </section>
    `).join("");

    return `
<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>${state.labName}</title>
<style>
  body{font-family:Arial;margin:0;color:${state.textColor}}
  .topbar{padding:20px;background:white;box-shadow:0 2px 8px rgba(0,0,0,.05)}
  .container{max-width:960px;margin:auto;padding:20px}
  .hero{padding:40px;background:#f4f6f9}
</style>
</head>
<body>

<header class="topbar">
  <div class="container"><strong>${state.labName}</strong></div>
</header>

<section class="hero">
  <div class="container">
    <h1>${state.labName}</h1>
    <p>${state.tagline}</p>
  </div>
</section>

${sectionsHtml}

<footer class="container" style="padding:40px 20px;color:#666">
  ¬© ${new Date().getFullYear()} ${state.labName}
</footer>

</body>
</html>`;
  }

  /* resto del script igual ‚Äî render, preview, etc. */

  // Initialization
  function updatePreview(){
    const html = generateFullHTML();
    const blob = new Blob([html],{type:"text/html"});
    const url = URL.createObjectURL(blob);
    preview.src = url;
  }

  updatePreview();

  </script>

</body>
</html>
